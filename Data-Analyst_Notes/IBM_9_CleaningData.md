
# CLEANING & WRANGLING DATA USING SPREADSHEETS #

# CLEANING DATA #

### SUMMARY ###

- It’s important to remove any duplicated or inaccurate data, and it’s important to remove any empty rows in your dataset. 

- There are several other types of data inconsistency that you may need to resolve, in order to properly clean your data:  
    · Change the case of text
    · Fix date formatting errors
    · Trim whitepace from your data  

- You can use the Flash Fill and Text to Columns features in Excel to manipulate and standardize your data, and functions can also be used to help manipulate and standardize your data. 



## REMOVING DUPLICATED OR INACCURATE DATA AND EMPTY ROWS ##

Now that we have learned about the importance of data quality and data privacy, in this video we will learn how to deal with inaccurate data, how to remove empty rows, and how to remove duplicated data. It’s very common when collecting or importing data - whether through manual or automated processes - to get errors and inconsistencies in your data. This can be as simple as spelling mistakes, extra white space, or the wrong case used in text, to empty rows or missing values in your data, to inaccurate or duplicated data. Having these errors and inconsistencies in your data can lead to issues with formulas not working, with unsuccessful sorting and filtering operations and therefore inadequately visualized and presented data findings. These data errors and inconsistencies require you to carry out some form of data-cleaning routine to improve the quality and usability of the data. Let’s start off with one of the easier of those tasks, which is spell checking. In Excel, this works in pretty much the same way as you may have already encountered in applications such as Microsoft Word or other common word processing applications. I have some data here relating to the sales of toy vehicles, and the first thing we need to do is select what data we wish to check for spelling; in this case we will try column K which contains the product line data. Then we click Spelling which is on the Review tab. Well that seems to be OK, so let’s try the Country information in column T. So, we do have an error here, where a country name has been misspelt, or more likely, mistyped. We just click Change if we are happy with the spelling suggestion, or we could choose another suggestion from the list, or even ignore this error if we know the data is correct, but in this case we will change it. Here’s another typo for a country name and here’s one more. So, that seems to be all the errors in this column, let’s try the final column now which is the deal size in column X. Here is a misspelling of the word small and another for medium. And that seems to be all for this column. The next inconsistency we will look for is empty rows. Empty rows in your data can cause lots of issues relating to moving around your data, working with formulas, and sorting and filtering. Therefore, it’s very important to remove them from your data. If you remember from an earlier lesson, when we click CTRL+DOWN ARROW, it should take us to the end of that column of data, but notice if we do that in this dataset, the cursor keeps stopping when it gets to an empty row meaning that the dataset if essentially being split into multiple sections, separated by these empty rows. That’s not good, so let’s resolve that now. We have a couple of options; one option is to just manually scroll down the sheet looking for empty rows and deleting each one, which is easy enough, and fine to do if you only have a small amount of data, but imagine if you were dealing with hundreds, or thousands, or even tens of thousands of rows? That would be a very laborious and time-consuming process. There is a much better way - which involves selecting all our data first, either using the mouse, or the CTRL+SHIFT+END keyboard shortcut. Then we select the Filter icon on the Data tab. We can now see that each column has a filter icon next to the column header. If we then select the Customer Name column-filter in column M then uncheck Select All then scroll down to the bottom of the list, we can check the item called Blanks, and then click OK. This will now show only the empty rows at the top of our sheet; this can be quite hard to see, but if you look in the row numbers, you can see that rows 28,29,65,73,74,75 and 117 are listed at the top and are highlighted in blue text. We can now select these rows, either using the mouse or going to the first cell in the first data row, which is A28, and then using the CTRL+SHIFT+END keyboard shortcut then delete the offending empty rows. We then need to clear the filter and turn it off, so we can view our data again. Now, if we go back to the first row in the top of the datasheet and try the CTRL+DOWN shortcut again, to go to the end of the data column, it will work. The next inconsistency we’ll look for is duplicated rows of data; it’s quite common for duplicate data rows to exist in your imported data, caused either by human input error, or an error in the import process. There are two ways of doing this in Excel; the first way includes reviewing the data you plan to remove first, before deleting it, to ensure you are deleting the right data. This is our preferred method as it provides an additional level of data security. The second method, which we will also show you, is simpler, as you don’t review the data to be removed first, but it lacks the security of the first method. It’s important to select a column of data that you would NOT expect to have duplicate values in. For example, if we consider the Price Each column, which is C, we would expect lots of these values to be repeated, because the unit price of some products is the same, so this is a bad example of a column to use to find duplicates. Instead, let’s use the Sales column in column E, because it is far less likely that these values will be duplicated in the normal process of things, as they are the total sales for each order. So, we select the column…and choose Conditional Formatting, then Highlight Cells Rules, and then Duplicate Values. When we click OK, and scroll down the sheet, we can see that only a few values have been identified as being duplicates. There seem to be duplicate values in rows 36 to 40 and in rows 74 to 78 Let’s zoom out so we can see both duplicate sections together. It seems like these are in fact exact duplicate entries, and are likely to be an input error. Let’s delete the second section of duplicate rows as they are out of sequence; as they relate to Motorcycles sales and are in the Ships section of the sheet. So that was the first, and recommended method of removing duplicate rows of data, which previews the data to be removed first. Now, let’s try the second, simpler, but less secure method. Let’s go back to 100% zoom, and go back to the top of the worksheet. This time, we select the whole datasheet, and on the Data tab, we use the Remove Duplicates button. We then unselect all the columns, then only select the Sales column. And the duplicate rows are deleted. The last cleaning process we’ll look at in this video is using the Find & Replace feature to repair some misspelt surnames in the customer contacts column. Find and Replace tools are under Find & Select on the Home tab in Excel, and if you have used other Office products such as Word, it should be familiar to you already. We’ve had an email from a Swedish customer, informing us that we have his surname spelt incorrectly on his order sheets. So, we type the misspelt surname in to the ‘Find what’ box and click Find Next, then click it again to see there are multiple incorrect entries. If we click Find All, all instances are listed, and we can open the Replace tab to enter a name to replace the incorrect spellings. His surname should be Larsson with a double ‘s’, so we’ll replace all instances with that corrected spelling. That looks better, and we are finished. In this video, we learned how to deal with inaccurate data, how to remove empty rows, and how to remove duplicated data. In the next video, we will look at changing the case of text, fixing date formatting errors, and trimming whitespace from data.



## DEALING WITH INCONSISTENCIES IN DATA ##

Now that we’ve learned how to deal with inaccurate data, how to remove empty rows, and how to remove duplicated data, in this video we’ll look at changing the case of text, fixing date formatting errors, and trimming whitespace from data. When you collect or receive data from varying sources, it’s quite common to find that your data contains text in mixed case; that is, some in uppercase, some in lowercase and some in capitalized proper case (also known as sentence case). Some of this may be intentional; but often it’s not. Excel doesn’t have a Change Case button like there is in Microsoft Word, so you need to use other methods to perform this data cleaning task. Those methods are functions; namely the UPPER, LOWER, and PROPER functions. You can use these functions to help you change the case of text in your data. You can see that the header row here is using all uppercase characters, so if you want to change that to use proper case then you need to add another row to put the function in; this is referred to as a ‘helper’ row. The PROPER function is simple to use; just type equals, then PROPER, then open parenthesis, then the cell reference - In this case A1 - then close parenthesis, and press Enter. Here you can see that the result in A2 is in proper case. Now you can try and drag the formula right across to column X by using the Fill Handle on A2... but this can be very tricky when you have a lot of columns, so let’s try another way. Instead of dragging, you can use SHIFT+RIGHT ARROW to select the columns across to X first then press F2 to bring the cursor into focus in cell A2 then you hold down the CTRL key while you press Enter, and it fills across for you. You might think that you could now remove the original row; but look what happens when you do; you get a REF error because the formula is referencing an invalid reference, and the header row cells now contain just the failed formula rather than the actual header text. So, you need to undo that, and instead, you copy the contents of the helper row to row 1 but when you paste you need to choose the Paste Values option. Now the header row cells just contain header text, and you can remove the helper row in row 2. Let’s now use the UPPER function to change text from proper case to upper case. Insert a column to the right of the column you want to change. This will be a ‘helper’ column. Then you type the formula containing the UPPER function in the first data cell in this new helper column. Again, it’s a simple formula; you type equals, then UPPER, then open parenthesis, then the cell reference – in this case T2 – and then close parenthesis and press Enter You can see the result is the country name in upper case, and you can then copy that formula down the rest of the column by double-clicking the Fill Handle cross symbol. As before, you then copy and paste the contents of the helper column to the original column, but use the Paste Values option. Now you can delete the helper column Next, we’ll use the LOWER function to change text from proper case to lower case. As before, you insert a column to the right of the column you want to change. This will be another ‘helper’ column. Then you type the formula containing the LOWER function in the first data cell in the helper column. Once again, it’s a very simple formula; you type equals, then LOWER, then open parenthesis, then the cell reference – in this case K2 – and then close parenthesis, and press Enter You can see the result is the product line data in lower case, and you can now copy the formula down to the rest of the column by double-clicking the Fill Handle once more. As before, you then copy and paste the contents of the helper column to the original column, but ensuring you use the Paste Values option. Now you can delete the helper column It’s quite common to receive data that has a mixture of date formats, or that uses a date format that isn’t suitable to your region. Now let’s look at how to change the format of some dates. You can see that this date format is currently using a 2-digit day, a 2-digit month, and a 4-digit year value. When you open the Number format dialog box, you can see in the Locale box, that this is an English (United Kingdom) date format. You want to use a US date format, so you first change the locale to English (United States). In this list, you can see there are several date options to choose from; let’s choose one which uses the full month name, then a 2-digit day, and a 4-digit year value. You could then copy this format to the rest of the date cells. However, if you want to format these dates using your own custom format, you can do that too. In the Number format list, you select Custom, and then choose an existing format that is similar to what you want and simply modify it to create a new custom format; here we’ll have the day, then 3-letter month, then 4-digit year. To apply that new custom date format to the rest of the column you could either use the Format Painter tool, or you can select the rest of the column and choose the new custom format from the Custom list in the Number Format dialog box. You might find that your data has some whitespace; that is, unwanted spaces in your data. Here you can see that we have some spaces at the start some spaces at the end and some unwanted double spaces in the middle of our data. We’ll first have a look at what you can do to clean up these unwanted spaces in your data by using the Find & Replace feature in Excel. So you first select all the data then on the Home tab, you click Find & Select, then Replace. To get rid of double spaces, you enter a double space in the ‘Find what’ box, and a single space in the ‘Replace with’ box. Then you click Find Next. And choose Replace for each item you want to change. You could click Replace All to do all the fixes in one go but unless you are absolutely sure of the changes, it’s better practice to check and replace each one in sequence in case there are some valid reasons for these extra spaces. If you have a very large dataset you might also choose Replace All to save you a lot of time. So using the Find & Replace feature got rid of most of those unwanted whitespaces, but not all of them; we removed double spaces using that feature, but we also have some single spaces left at the start and end of some of the cells. You can’t use Find & Replace to remove single spaces otherwise you would lose ALL spaces in your data - including standard spaces between words - which you don’t want to remove. But, there is another tool you can use to clear spaces from cells, and that’s the TRIM function. To use the TRIM function, you once again insert a helper column. The TRIM function is simple to use; just type equals, then TRIM, then open parenthesis, then the cell reference – in this case M2 – then close parenthesis, and press Enter. You can then double-click the Fill Handle symbol to copy this formula down to the remainder of the column. Now you need to copy the contents of the new column N to column M, and remember once again to paste using the Paste Values option. You can now see that those erroneous spaces have been removed, or more accurately speaking, have been trimmed. And lastly, you can remove the helper column. In this video, we learned how to change the case of text, how to change date formatting, and how to trim whitespace from data. In the next video, we will discuss how to use the Flash Fill and Text to Columns features in Excel to help clean data.



## MORE EXCEL FEATURES FOR CLEANING DATA ##

Now that we’ve learned how to change the case of text, how to change date formatting, and how to trim whitespace from data, in this video we’ll discuss how to use the Flash Fill and Text to Columns features in Excel to help clean data. We used Flash Fill briefly earlier in the course as a quick method of entering data that fits a specific pattern, such as the names of months or days of the week, but it can also be useful as a data cleaning tool. It can split a column of full names into two separate columns for the forename and surname, and it can also help to modify the naming convention used in a column of names. For example, in the vehicle toy sales worksheet there is a column containing the last names of contacts, and another containing their first names. If you want to use the Flash Fill feature to combine these names into one name column, you first insert a helper column; let’s call it ‘Contactname’. Then, in the first row in the new column you enter the full name of the first contact in the format of your choice; for example you might want surname, then a comma, then the forename, or you might want surname, and just an initial, and so on; in this case let’s just enter the name in the standard format of forename then surname with a space between them, and then we press Enter. Next you start typing the second contact’s name in, and you’ll see that Flash Fill displays a preview of the remaining names for you. If you’re happy with what’s in the preview, all you have to do is press Enter, and it fills in the remaining names for you right down the column. It even works when there are two names in one of the columns such as Wing C here … and Da Cunha here. Now you can remove the original columns if you no longer need them. So, in the previous task we saw how to combine two columns of data into one column using Flash Fill; now let’s see how to use it to modify the naming convention in a column. Let’s switch to the customer contacts worksheet. Then in the first data row of the next column, that is B2, we type the name of the first contact using whatever naming convention we want. We’ll use surname, then comma, then a space, then the forename, and press Enter. Again, when we start typing the second contact’s name in the next row down, that is B3, Flash Fill detects the pattern and fills in the remaining names in column B when we press Enter. You could then copy and paste the column header, and delete the original column A. What we couldn’t do with Flash Fill was take a single column with two names in and split that into two separate columns. We need to use the ‘Text to Columns’ feature to do that. So, we’ll close this worksheet and we won’t save the changes. Now, let’s see how the ‘Text to Columns’ feature can help with data cleaning too. As the name suggests, and unlike Flash Fill, the ‘Text to Columns’ feature can take a column containing multi-part text and split that text into one or more other columns. This can be useful for splitting any multi-part text, such as names or addresses, into separate component parts. Let’s open the customer contacts worksheet again. Then we’ll add column headings for the next two columns, and copy the cell format used in the first column header. Then we’ll widen the columns. If we then select the data in column A from A2 to A23, and on the Data tab, click Text to Columns, a wizard is launched. On the first page of the wizard, ensure that ‘Delimited’ is selected. On the second page, ensure that only ‘Space’ is selected as the delimiter. On the third page of the wizard, click the little arrow next to ‘Destination’… and select cell B2 on the worksheet, then click the little arrow again to return to the wizard. We’re now finished with this wizard. You can see that the full customer contact names in column A have now been successfully split into two new columns in B and C, and you could now remove column A if you no longer need it. We’ll close this worksheet, and again we won’t save the changes. You can also achieve the same result using functions. This would be required if you were using ‘Excel for the web’, the online version of Excel, as this doesn’t have the ‘Text to Columns’ feature. There’s also a bit more flexibility with functions, which can be especially useful if you have names that are complex and mixed, such as having hyphenated names or some names with a middle initial, some with two middle initials, and some with no middle initial. So, we open the customer contacts worksheet again. Then we’ll add column headings for the next two columns, and copy the cell format used in the first column header. Then we’ll widen the columns. Next, we enter the formula in B2 to extract the forename part of the name. This formula extracts five characters from cell A2, starting from the left and including the space. Then, in cell C2 we enter the formula to extract the surname part of the name. This formula extracts seven characters from cell A2, starting from the right. Then we double-click the Fill Handle in cell B2 to use AutoFill to complete the column. And we do the same to the Fill Handle in cell C2 to use AutoFill to complete that column also. In this video, we learned how to use the Flash Fill and Text to Columns features in Excel to help clean data.